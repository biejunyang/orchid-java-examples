# 数据重复插入问题处理，如何保证数据的唯一性？

通常实现方式：
    a、select value from tbl、判断数据是否存在于
    b、存在则插入失败、不存在则插入

问题：某个时间内并发次数较多，或者判断是否重复语句，到方法执行完执行事务插入数据之间处理时间比较长的时候，
    容易插入重复数据。
    
    
如何确保插入数据的唯一性？
   1、数据库层使用唯一索引、数据重复插入时会引发程序异常、可以捕捉该异常提示重复。
       
       
   2、使用insert into select语句进行插入、语句判断插入之前是否数据是否存在
        如插入name数据时，先判断名成是否存在：
        insert into tba(name) SELECT 'zhangsan' WHERE NOT EXISTS(SELECT * FROM  tba WHERE name='zhangsan')
   
   3、使用分布式锁，控制并发、保证数据的唯一性：
    
    
   比较：
   -- 10秒起，20个线程、每个线程插入10次、完成200次插入
   -- 一般方式、10秒、插入136数据、重复数据9
   -- 添加唯一索引、10s、插入130数据、重复0
   -- insert select方式、耗时13s 插入126重复0
   -- 使用分布式锁、耗时10s 插入128重复0